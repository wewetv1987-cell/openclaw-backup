# 进度反馈系统

> 确保用户随时了解代理工作状态，避免长时间无反馈

## 反馈规则

### 1. 进度汇报频率

| 任务类型 | 汇报频率 | 方式 |
|---------|---------|------|
| **设计方案** | **每1分钟** | 当前进度 + 思考内容 |
| 编程任务 | 每完成一个函数/模块 | 代码片段 + 说明 |
| 自动化任务 | 每个操作步骤 | 操作日志 |
| 学习任务 | 每10分钟或关键发现 | 知识点总结 |
| 金融任务 | 数据变化时 | 数据报告 |
| 长任务(>5分钟) | **每1分钟** | 进度条 |
| **任何任务** | **每60秒** | 必须有反馈 |

### 2. 进度条格式

```
[Agent] 任务名称
进度: ████████░░ 80% (步骤 4/5)
状态: 正在处理...
预计: ~1分钟
```

### 3. 阶段性报告模板

```markdown
## 📊 进度报告

**代理**: Coder
**任务**: 实现用户登录
**耗时**: 3分20秒
**状态**: ✅ 完成

### 完成内容
- [x] 登录API接口
- [x] JWT token生成
- [x] 密码加密验证
- [x] 错误处理

### 产出文件
- `/api/auth/login.js`
- `/middleware/jwt.js`

### 下一步建议
- 添加刷新token功能
- 实现登出接口
```

### 4. 阻塞处理

当任务阻塞超过30秒：

```
⚠️ 阻塞警告

**代理**: Automator
**任务**: 抓取商品数据
**阻塞原因**: 网页加载超时
**已等待**: 45秒
**处理方案**: 
  1. 重试 (2/3次)
  2. 切换代理IP
  3. 跳过当前商品

需要您的决定吗？
```

### 5. 长任务通知

超过5分钟的任务：

```
⏰ 长任务提醒

**任务**: 分析1000条代码
**已执行**: 8分钟
**进度**: 60% (600/1000)
**预计剩余**: 5分钟

我会持续工作并在完成时通知您。
如需中断，请说"停止"。
```

## 反馈命令

用户可以随时查询：

```
"进度怎么样" → 显示所有进行中的任务
"状态" → 显示代理状态
"任务列表" → 显示队列
"停止 xxx" → 停止指定任务
```

## 示例对话

```
用户: 帮我写一个完整的用户管理系统

Main: 收到！这是一个较大的任务，我来分解：

📋 任务分解:
1. [Coder] 设计数据库模型 (~5分钟)
2. [Coder] 实现用户CRUD API (~15分钟)
3. [Coder] 添加权限验证 (~10分钟)
4. [Learner] 整理API文档 (~5分钟)

预计总耗时: ~35分钟

现在开始执行第一个任务...

---

[Coder] 开始设计数据库模型
进度: █░░░░░░░░░ 10%
当前: 分析字段需求...

[10秒后]

[Coder] 数据库模型设计完成
进度: ██████████ 100%
产出: /models/User.js
耗时: 2分钟

开始下一个任务: 实现CRUD API...

---

[Coder] 实现用户API
进度: ████░░░░░░ 40% (2/5)
- [x] 创建用户
- [x] 查询用户
- [ ] 更新用户
- [ ] 删除用户
- [ ] 列表分页

预计剩余: 8分钟
```

---
*Created: 2026-02-16*
