# LOCAL_KNOWLEDGE_SYSTEM.md - 本地优先知识调用系统

> 策略：优先使用本地记忆和知识库，找不到相关资料时再调用模型

## 🎯 核心原则

### 1. 本地优先
```
用户问题 → 搜索本地记忆 → 找到 → 使用本地知识
                              ↓
                            未找到 → 调用模型 → 保存到本地
```

### 2. 知识分层
- **短期记忆**: `memory/daily/` (最近48小时)
- **长期记忆**: `memory/` (重要决策、偏好、待办)
- **知识库**: `memory/knowledge/` (系统化知识)
- **项目文档**: `projects/` (具体项目资料)

### 3. 自动学习与积累
- 模型回答的重要知识 → 自动保存到知识库
- 重复问题 → 直接从知识库回答
- 知识更新 → 版本控制 + Git 同步

## 🔍 搜索优先级

### 第一优先级：精确匹配
```
memory_search(query) → memory_get(相关片段)
```

### 第二优先级：知识库搜索
```
搜索 memory/knowledge/ 相关领域
```

### 第三优先级：项目文档
```
搜索 projects/ 相关项目
```

### 第四优先级：调用模型
```
当本地无相关资料时，调用模型
```

## 📁 本地知识库结构

### 1. 记忆系统 (`memory/`)
```
memory/
├── daily/              # 每日记忆 (最近48小时)
├── knowledge/          # 知识库 (按领域分类)
│   ├── finance/        # 金融知识
│   ├── programming/    # 编程知识
│   ├── reverse/        # 逆向工程
│   └── vibe-coding/    # Vibe Coding
├── logs/               # 系统日志
└── *.md               # 长期记忆文件
```

### 2. 知识领域分类
| 领域 | 文件数 | 最后更新 | 进度 |
|------|--------|----------|------|
| 金融 | 6 | 2026-02-17 | 基础100% |
| 编程 | 5 | 2026-02-17 | 基础95% |
| 逆向工程 | 6 | 2026-02-17 | 基础100% |
| Vibe Coding | 12 | 2026-02-17 | 基础70% |

### 3. 项目文档 (`projects/`)
```
projects/
├── user-auth/         # 用户认证项目
└── [其他项目]/
```

## 🔧 使用流程

### 步骤1：问题分析
```bash
# 分析问题类型
- 技术问题 → 搜索 programming/
- 金融问题 → 搜索 finance/
- 配置问题 → 搜索 memory/
- 项目问题 → 搜索 projects/
```

### 步骤2：本地搜索
```bash
# 使用 memory_search 工具
memory_search("查询关键词")
```

### 步骤3：知识提取
```bash
# 使用 memory_get 获取具体内容
memory_get("path/to/file.md", from=10, lines=20)
```

### 步骤4：模型调用 (备用)
```bash
# 当本地无相关资料时
# 调用模型，并将回答保存到知识库
```

## 💾 知识保存规则

### 1. 自动保存
- 模型回答的重要知识点 → 保存到 `memory/knowledge/`
- 配置决策 → 保存到 `memory/YYYY-MM-DD.md`
- 项目进展 → 保存到 `projects/[项目]/docs/`

### 2. 分类保存
```markdown
# 保存模板
## [主题]
**来源**: 模型回答 / 学习资料
**时间**: YYYY-MM-DD HH:MM
**内容**: [知识点]
**标签**: [分类标签]
```

### 3. 版本控制
- 所有知识文件纳入 Git 版本控制
- 每日自动提交到 GitHub
- 重要更新立即提交

## 🚀 优化策略

### 1. 搜索优化
- 使用语义搜索 (memory_search)
- 建立关键词索引
- 定期清理过期记忆

### 2. 知识更新
- 定期复习和更新知识
- 合并重复知识
- 标记过时信息

### 3. 性能优化
- 缓存常用知识
- 预加载高频领域
- 增量搜索

## 📊 监控指标

### 1. 命中率
```
本地知识命中率 = (本地回答数 / 总问题数) × 100%
目标: > 70%
```

### 2. 知识增长
```
每日新增知识文件数
知识库总大小 (MB)
分类完整性
```

### 3. 响应时间
```
本地搜索平均时间
模型调用平均时间
```

## 🔄 Git 同步策略

### 1. 自动提交
```bash
# 每日定时提交
0 2 * * * cd ~/.openclaw/workspace && git add . && git commit -m "每日自动提交"
```

### 2. 重要更新立即提交
- 配置更改
- 重要知识添加
- 项目里程碑

### 3. 远程同步
```bash
# 推送到 GitHub
git push origin main

# 从 GitHub 拉取更新
git pull origin main
```

## 🎯 实施检查清单

- [x] 配置 memory_search 工具
- [x] 组织知识库结构
- [x] 建立 Git 版本控制
- [x] 配置自动提交
- [x] 测试本地搜索流程
- [x] 监控命中率指标

---

*最后更新: 2026-02-17 16:39*
*版本: 1.0.0*